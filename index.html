<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bashing Birthday - Scratch Edition</title>
    <style>
        :root { --gold: #d4af37; --matrix: #00ff00; --bg: #0a0a0a; }
        body { background-color: var(--bg); color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; font-family: 'Courier New', monospace; overflow: hidden; }
        
        #clock-container { 
            padding: 40px; border: 3px solid #333; border-radius: 25px; 
            text-align: center; background: #151515; transition: all 0.1s ease; 
            z-index: 10; min-width: 380px; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            position: relative;
        }

        #time-display { font-weight: bold; font-size: clamp(40px, 12vw, 85px); margin: 10px 0; color: var(--matrix); text-shadow: 0 0 15px rgba(0,255,0,0.2); }
        #msg-area { font-size: 26px; font-weight: bold; height: 40px; margin-bottom: 10px; text-transform: uppercase; }

        .party-on { border-color: var(--gold) !important; background-color: #1a1608 !important; box-shadow: 0 0 80px rgba(212, 175, 55, 0.4) !important; }
        .party-on #time-display { color: var(--gold) !important; text-shadow: 0 0 25px rgba(212, 175, 55, 0.6) !important; }

        .controls { margin-top: 20px; padding-top: 20px; border-top: 1px solid #333; display: flex; flex-direction: column; gap: 15px; }
        
        #scratch-area {
            width: 100%; height: 80px; border-radius: 10px; overflow: hidden;
            margin-bottom: 15px; border: 1px solid #444;
        }

        input[type="text"] { background: #222; color: white; border: 1px solid #444; padding: 8px; border-radius: 5px; font-family: inherit; width: 100px; text-align: center; margin: 0 auto; outline: none; }
        
        .toggle-btn { 
            background: #333; color: white; border: none; padding: 15px 30px; 
            font-family: inherit; font-weight: bold; border-radius: 50px; 
            cursor: pointer; transition: 0.3s; font-size: 14px;
        }

        .btn-active { background: var(--gold); color: black; box-shadow: 0 0 25px var(--gold); }
        canvas { position: absolute; top: 0; left: 0; pointer-events: none; }
    </style>
</head>
<body onclick="createConfetti(event)">

<canvas id="canvas"></canvas>

<div id="clock-container">
    <div id="scratch-area">
        <iframe src="https://scratch.mit.edu/projects/1167268640/embed" allowtransparency="true" width="100%" height="80" frameborder="0" scrolling="no" allowfullscreen></iframe>
    </div>

    <div id="time-display">00:00:00</div>
    <div id="msg-area">READY TO BASH</div>
    
    <div class="controls" onclick="event.stopPropagation()">
        <input type="text" id="bday-input" placeholder="03/03" maxlength="5">
        <button id="party-toggle" class="toggle-btn" onclick="toggleParty()">VISUAL MODE ðŸ˜ˆ</button>
        <div style="font-size: 10px; color: #666; margin-top: 5px;">Click the Green Flag inside the Scratch box to start the beat!</div>
    </div>
</div>

<script>
    let partyMode = false;
    const bdayInput = document.getElementById('bday-input');

    bdayInput.value = localStorage.getItem('userBirthday') || "03/03";
    bdayInput.oninput = () => { if(bdayInput.value.length === 5) localStorage.setItem('userBirthday', bdayInput.value); };

    function toggleParty() {
        partyMode = !partyMode;
        const btn = document.getElementById('party-toggle');
        const container = document.getElementById('clock-container');
        
        if(partyMode) {
            container.classList.add('party-on');
            btn.classList.add('btn-active');
            btn.innerText = "PARTY ON ðŸ›‘";
        } else {
            container.classList.remove('party-on');
            btn.classList.remove('btn-active');
            btn.innerText = "VISUAL MODE ðŸ˜ˆ";
        }
    }

    function update() {
        const now = new Date();
        document.getElementById('time-display').innerText = now.toLocaleTimeString('en-GB');
        if (partyMode) {
            document.getElementById('clock-container').style.transform = "scale(1.05)";
            setTimeout(() => { document.getElementById('clock-container').style.transform = "scale(1)"; }, 70);
        }
    }

    // --- CONFETTI ---
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let particles = [];
    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.onresize = resize; resize();
    function createConfetti(e) {
        for(let i=0; i<20; i++) {
            particles.push({
                x: e.clientX, y: e.clientY,
                vx: (Math.random()-0.5)*22, vy: (Math.random()-0.5)*22,
                size: Math.random()*9+2, color: i % 2 === 0 ? '#d4af37' : '#ffffff',
                r: Math.random()*360, sp: Math.random()*25-12
            });
        }
    }
    function animate() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        particles.forEach((p,i) => {
            p.x += p.vx; p.y += p.vy; p.vy += 0.45; p.r += p.sp;
            ctx.fillStyle = p.color;
            ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.r*Math.PI/180);
            ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size); ctx.restore();
            if(p.y > canvas.height) particles.splice(i,1);
        });
        requestAnimationFrame(animate);
    }
    setInterval(update, 1000);
    animate();
</script>
</body>
</html>
