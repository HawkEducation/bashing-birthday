<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Bash</title>
    <style>
        :root { --gold: #d4af37; --matrix: #00ff00; --bg: #0a0a0a; }
        body { background-color: var(--bg); color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; font-family: 'Courier New', monospace; overflow: hidden; }
        
        #clock-container { 
            padding: 40px; border: 3px solid #333; border-radius: 25px; 
            text-align: center; background: #151515; transition: all 0.1s ease; 
            z-index: 10; min-width: 380px;
        }

        #time-display { font-weight: bold; font-size: clamp(40px, 12vw, 85px); margin: 10px 0; color: var(--matrix); text-shadow: 0 0 15px rgba(0,255,0,0.2); }
        #msg-area { font-size: 26px; font-weight: bold; height: 40px; margin-bottom: 10px; text-transform: uppercase; }
        #countdown-display { font-size: 16px; color: #ff9f43; margin-bottom: 20px; }

        .party-on { border-color: var(--gold) !important; background-color: #1a1608 !important; box-shadow: 0 0 80px rgba(212, 175, 55, 0.4) !important; }
        .party-on #time-display { color: var(--gold) !important; text-shadow: 0 0 25px rgba(212, 175, 55, 0.6) !important; }

        .controls { margin-top: 20px; padding-top: 20px; border-top: 1px solid #333; display: flex; flex-direction: column; gap: 12px; }
        
        input { 
            background: #222; color: white; border: 1px solid var(--gold); 
            padding: 8px; border-radius: 5px; font-family: inherit; width: 100px; text-align: center; margin: 0 auto;
        }

        .toggle-btn { 
            background: #333; color: white; border: none; padding: 15px 30px; 
            font-family: inherit; font-weight: bold; border-radius: 50px; 
            cursor: pointer; transition: 0.3s; font-size: 14px; letter-spacing: 1px;
        }

        .btn-active { background: var(--gold); color: black; box-shadow: 0 0 25px var(--gold); }
        
        #yt-player { position: absolute; top: -9999px; left: -9999px; }
        canvas { position: absolute; top: 0; left: 0; pointer-events: none; }
        .pulse { animation: pulse 0.7s infinite ease-in-out; color: var(--gold); }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
    </style>
</head>
<body onclick="createConfetti(event)">

<canvas id="canvas"></canvas>

<iframe id="yt-player" width="1" height="1" src="https://www.youtube.com/embed/S_7UvY7OidU?enablejsapi=1" frameborder="0" allow="autoplay"></iframe>

<div id="clock-container">
    <div id="time-display">00:00:00</div>
    <div id="msg-area">WAITING...</div>
    <div id="countdown-display">SET DATE BELOW</div>
    
    <div class="controls" onclick="event.stopPropagation()">
        <label style="font-size: 10px; color: #666;">BIRTHDAY (MM/DD)</label>
        <input type="text" id="bday-input" placeholder="03/03" maxlength="5">
        
        <button id="party-toggle" class="toggle-btn" onclick="toggleParty()">ACTIVATE PHONK ðŸ˜ˆ</button>
    </div>
</div>

<script>
    let partyMode = false;
    const bdayInput = document.getElementById('bday-input');
    const player = document.getElementById('yt-player');
    
    // Load saved birthday
    bdayInput.value = localStorage.getItem('userBirthday') || "03/03";

    bdayInput.oninput = () => {
        if(bdayInput.value.length === 5) {
            localStorage.setItem('userBirthday', bdayInput.value);
        }
    };

    function toggleParty() {
        partyMode = !partyMode;
        const btn = document.getElementById('party-toggle');
        const container = document.getElementById('clock-container');
        
        // Command to YT Player
        const command = partyMode ? '{"event":"command","func":"playVideo","args":""}' : '{"event":"command","func":"pauseVideo","args":""}';
        player.contentWindow.postMessage(command, '*');

        if(partyMode) {
            container.classList.add('party-on');
            btn.classList.add('btn-active');
            btn.innerText = "STOP THE PHONK ðŸ›‘";
        } else {
            container.classList.remove('party-on');
            btn.classList.remove('btn-active');
            btn.innerText = "ACTIVATE PHONK ðŸ˜ˆ";
        }
    }

    function update() {
        const now = new Date();
        const container = document.getElementById('clock-container');
        
        // Visual Bass Kick
        if (partyMode) {
            container.style.transform = "scale(1.04)";
            setTimeout(() => { container.style.transform = "scale(1)"; }, 70);
        }

        document.getElementById('time-display').innerText = now.toLocaleTimeString('en-GB');
        
        const currentMMDD = (now.getMonth() + 1).toString().padStart(2, '0') + '/' + now.getDate().toString().padStart(2, '0');
        const userBday = bdayInput.value;
        const msgArea = document.getElementById('msg-area');
        const countArea = document.getElementById('countdown-display');

        if (currentMMDD === userBday) {
            msgArea.innerText = "ðŸŽ‚ HAPPY BIRTHDAY! ðŸŽ‚";
            msgArea.classList.add('pulse');
            countArea.innerText = "THE BASH IS OFFICIALLY LIVE";
            if (!partyMode) toggleParty(); // Auto-start Phonk on the actual day
        } else {
            msgArea.innerText = partyMode ? "PASO BEM SOLTO" : "BASHING SOON";
            if(partyMode) msgArea.classList.add('pulse');
            else msgArea.classList.remove('pulse');

            if(userBday.length === 5) {
                const [m, d] = userBday.split('/');
                let target = new Date(now.getFullYear(), m-1, d);
                if (target < now) target.setFullYear(now.getFullYear() + 1);
                const diff = target - now;
                const days = Math.floor(diff / 86400000);
                const hrs = Math.floor((diff / 3600000) % 24);
                const mins = Math.floor((diff / 60000) % 60);
                const secs = Math.floor((diff / 1000) % 60);
                countArea.innerText = `COUNTDOWN: ${days}d ${hrs}h ${mins}m ${secs}s`;
            }
        }
    }

    // --- CONFETTI ENGINE ---
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let particles = [];
    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.onresize = resize; resize();
    function createConfetti(e) {
        // Fallback: If music is blocked, clicking background for confetti might wake it up
        if(partyMode) player.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
        
        for(let i=0; i<15; i++) {
            particles.push({
                x: e.clientX, y: e.clientY,
                vx: (Math.random()-0.5)*18, vy: (Math.random()-0.5)*18,
                size: Math.random()*8+2, color: i % 2 === 0 ? '#d4af37' : '#ffffff',
                r: Math.random()*360, sp: Math.random()*20-10
            });
        }
    }
    function animate() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        particles.forEach((p,i) => {
            p.x += p.vx; p.y += p.vy; p.vy += 0.4; p.r += p.sp;
            ctx.fillStyle = p.color;
            ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.r*Math.PI/180);
            ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size); ctx.restore();
            if(p.y > canvas.height) particles.splice(i,1);
        });
        requestAnimationFrame(animate);
    }

    setInterval(update, 1000);
    update();
    animate();
</script>
</body>
</html>
